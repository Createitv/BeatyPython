# 访问者模式

Represent an operation to be performed on the elements of an object structure.Visitor lets you define a new operation without changing the classes of the elements on which it operates.
封装一些作用于某种数据结构中各元素的操作，它可以在不改变数据结构的前提下定义作用于这些元素的新的操作。

访问模式的核心思想在于：可以在不改变数据结构的前提下定义作用于这些元素的新操作。将数据结构和操作（或算法）进行解耦，而且能更方便地拓展新的操作。

![访问模式](https://typora-1300715298.cos.ap-shanghai.myqcloud.com/uPic/image-20210615191749581.png)

### 设计要点

访问模式中主要有三个角色，在设计访问模式时要找到并区分这些角色。
（1）访问者（Visitor）：负责对数据节点进行访问和操作。
（2）数据节点（DataNode）：即要被操作的数据对象。
（3）对象结构（ObjectStructure）：数据结构的管理类，也是数据对象的一个容器，可遍历容器内的所有元素。

### 访问模式的优缺点

#### 优点：

（1）将数据和操作（算法）分离，降低了耦合度。将有关元素对象的访问行为集中到一个访问者对象中，而不是分散在一个个的元素类中，类的职责更加清晰。
（2）增加新的访问操作很方便。使用访问模式，增加新的访问操作就意味着增加一个新的具体访问者类，实现简单，无须修改源代码，符合“开闭原则”。
（3）让用户能够在不修改现有元素类层次结构的情况下，定义作用于该层次结构的操作。

#### 缺点：

（1）增加新的元素类很困难。在访问模式中，每增加一个新的元素类都意味着要在抽象访问者角色中增加一个新的抽象操作，并在每一个具体访问者类中增加相应的具体操作，这违背了“开闭-原则”的要求。
（2）破坏数据对象的封装性。访问模式要求访问者对象能够访问并调用每一个元素的操作细节，这意味着元素对象有时候必须暴露一些自己的内部操作和内部状态，否则无法供访问者访问。
